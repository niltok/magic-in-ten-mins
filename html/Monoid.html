<html>
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=0">
<title>
ååˆ†é’Ÿé­”æ³•ç»ƒä¹ </title>
<style>
body { max-width: 650px; margin: auto; width: 90%; margin-top: 10%; margin-bottom: 10%; color: #0B0E26; background: #FAFAFC; line-height: 2em; }
body { font-family: -apple-system,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Microsoft YaHei,Source Han Sans SC,Noto Sans CJK SC,WenQuanYi Micro Hei,sans-serif; }
h1 { font-size: 2.5em; color: #EF96AB; line-height: 1.5em; }
h2 { margin-top: 2em; line-height: 1.5em; }
blockquote { color: gray; margin: 0; padding: 1 1 1 20; border-left: 5px solid #EF96AB; }
code, pre { font-family: Consolas,Menlo,Monaco,source-code-pro,Courier New,monospace; background: #FCF6FC; border-radius: 3px; padding-inline: 0.3rem; }
pre { overflow-x: auto; padding: 10px; }
a { color: #02AEF1; text-decoration: none; }
@media (prefers-color-scheme: dark) { body { color: #D8D8D6; background: #0E0E10; } }
@media (prefers-color-scheme: dark) { pre, code { color: #D8D8D6; background: #0E0F1F; } }
.hljs-keyword { color: #F288AF; }
.hljs-comment { color: #929CA6; }
.hljs-string { color: #0594A6; }
.hljs-title { color: #4581D9 }
</style>
</head>
<body>
<p>
<a href="https://magic.huohuo.moe">ğŸ HomepageğŸ </a> | <a href="https://github.com/niltok/magic-in-ten-mins">â­Star me on GitHubâ­</a></p>
<h1 id="ååˆ†é’Ÿé­”æ³•ç»ƒä¹ ï¼šå•ä½åŠç¾¤">ååˆ†é’Ÿé­”æ³•ç»ƒä¹ ï¼šå•ä½åŠç¾¤</h1>
<h3 id="by-ã€Œç©ç«ã€">By ã€Œç©ç«ã€</h3>
<blockquote>
<p>å‰ç½®æŠ€èƒ½ï¼šJavaåŸºç¡€</p>
</blockquote>
<h2 id="åŠç¾¤ï¼ˆsemigroupï¼‰">åŠç¾¤ï¼ˆSemigroupï¼‰</h2>
<p>åŠç¾¤æ˜¯ä¸€ç§ä»£æ•°ç»“æ„ï¼Œåœ¨é›†åˆ <code>A</code> ä¸ŠåŒ…å«ä¸€ä¸ªå°†ä¸¤ä¸ª <code>A</code> çš„å…ƒç´ æ˜ å°„åˆ° <code>A</code> ä¸Šçš„è¿ç®—å³ <code>&lt;&gt; : (A, A) -&gt; Aâ€‹</code> ï¼ŒåŒæ—¶è¯¥è¿ç®—æ»¡è¶³<strong>ç»“åˆå¾‹</strong>å³ <code>(a &lt;&gt; b) &lt;&gt; c == a &lt;&gt; (b &lt;&gt; c)</code> ï¼Œé‚£ä¹ˆä»£æ•°ç»“æ„ <code>{&lt;&gt;, A}</code> å°±æ˜¯ä¸€ä¸ªåŠç¾¤ã€‚</p>
<p>æ¯”å¦‚åœ¨è‡ªç„¶æ•°é›†ä¸Šçš„åŠ æ³•æˆ–è€…ä¹˜æ³•å¯ä»¥æ„æˆä¸€ä¸ªåŠç¾¤ï¼Œå†æ¯”å¦‚å­—ç¬¦ä¸²é›†ä¸Šå­—ç¬¦ä¸²çš„è¿æ¥æ„æˆä¸€ä¸ªåŠç¾¤ã€‚</p>
<h2 id="å•ä½åŠç¾¤ï¼ˆmonoidï¼‰">å•ä½åŠç¾¤ï¼ˆMonoidï¼‰</h2>
<p>å•ä½åŠç¾¤æ˜¯ä¸€ç§å¸¦å•ä½å…ƒçš„åŠç¾¤ï¼Œå¯¹äºé›†åˆ <code>A</code> ä¸Šçš„åŠç¾¤ <code>{&lt;&gt;, A}</code> ï¼Œ <code>A</code> ä¸­çš„å…ƒç´  <code>a</code> ä½¿ <code>A</code> ä¸­çš„æ‰€æœ‰å…ƒç´  <code>x</code> æ»¡è¶³ <code>x &lt;&gt; a</code> å’Œ <code>a &lt;&gt; x</code> éƒ½ç­‰äº <code>x</code>ï¼Œåˆ™ <code>a</code> å°±æ˜¯ <code>{&lt;&gt;, A}</code> ä¸Šçš„å•ä½å…ƒã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œ <code>{+, è‡ªç„¶æ•°é›†}</code> çš„å•ä½å…ƒå°±æ˜¯ 0 ï¼Œ <code>{*, è‡ªç„¶æ•°é›†}</code> çš„å•ä½å…ƒå°±æ˜¯ 1 ï¼Œ <code>{+, å­—ç¬¦ä¸²é›†}</code> çš„å•ä½å…ƒå°±æ˜¯ç©ºä¸² <code>&quot;&quot;</code> ã€‚</p>
<p>ç”¨ Java ä»£ç å¯ä»¥è¡¨ç¤ºä¸ºï¼š</p>
<pre><code class="language-java"><span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Monoid</span>&lt;<span class="hljs-title">T</span>&gt; </span>{
    <span class="hljs-function">T <span class="hljs-title">empty</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function">T <span class="hljs-title">append</span><span class="hljs-params">(T a, T b)</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">default</span> T <span class="hljs-title">appends</span><span class="hljs-params">(Stream&lt;T&gt; x)</span> </span>{
        <span class="hljs-keyword">return</span> x.reduce(empty(), <span class="hljs-keyword">this</span>::append);
    }
}</code></pre>
<h2 id="åº”ç”¨ï¼šoptional">åº”ç”¨ï¼šOptional</h2>
<p>åœ¨ Java8 ä¸­æœ‰ä¸ªæ–°çš„ç±» <code>Optional</code> å¯ä»¥ç”¨æ¥è¡¨ç¤ºå¯èƒ½æœ‰å€¼çš„ç±»å‹ï¼Œè€Œæˆ‘ä»¬å¯ä»¥å¯¹å®ƒå®šä¹‰ä¸ª Monoid ï¼š</p>
<pre><code class="language-java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OptionalM</span>&lt;<span class="hljs-title">T</span>&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title">Monoid</span>&lt;<span class="hljs-title">Optional</span>&lt;<span class="hljs-title">T</span>&gt;&gt; </span>{
    <span class="hljs-function"><span class="hljs-keyword">public</span> Optional&lt;T&gt; <span class="hljs-title">empty</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> Optional&lt;T&gt;.empty();
    }
    <span class="hljs-function"><span class="hljs-keyword">public</span> Optional&lt;T&gt; 
    <span class="hljs-title">append</span><span class="hljs-params">(Optional&lt;T&gt; a, Optional&lt;T&gt; b)</span> </span>{
        <span class="hljs-keyword">if</span> (a.isPresent()) <span class="hljs-keyword">return</span> a;
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> b;
    }
}</code></pre>
<p>è¿™æ ·å¯¹äº appends æ¥è¯´æˆ‘ä»¬å°†è·å¾—ä¸€ä¸² Optional ä¸­ç¬¬ä¸€ä¸ªä¸ä¸ºç©ºçš„å€¼ï¼Œå¯¹äºéœ€è¦è¿›è¡Œä¸€è¿ä¸²å°è¯•æ“ä½œå¯ä»¥è¿™æ ·å†™ï¼š</p>
<pre><code class="language-java"><span class="hljs-keyword">new</span> OptionalM&lt;<span class="hljs-keyword">int</span>&gt;.appends(Stream.of(try1(), try2(), try3(), try4()))</code></pre>
<h2 id="åº”ç”¨ï¼šordering">åº”ç”¨ï¼šOrdering</h2>
<p>å¯¹äº <code>Comparable</code> æ¥å£å¯ä»¥æ„é€ å‡ºï¼š</p>
<pre><code class="language-java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OrderingM</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Monoid</span>&lt;<span class="hljs-title">int</span>&gt; </span>{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">empty</span><span class="hljs-params">()</span> </span>{ <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>; }
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">append</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b)</span> </span>{
        <span class="hljs-keyword">if</span> (a == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> b;
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> a;
    }
}</code></pre>
<p>åŒæ ·å¦‚æœæœ‰ä¸€ä¸²å¸¦æœ‰ä¼˜å…ˆçº§çš„æ¯”è¾ƒæ“ä½œå°±å¯ä»¥ç”¨ appends ä¸²èµ·æ¥ï¼Œæ¯”å¦‚ï¼š</p>
<pre><code class="language-java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Student</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Comparable</span> </span>{
    String name;
    String sex;
    Date birthday;
    String from;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">compareTo</span><span class="hljs-params">(Object o)</span> </span>{
        Student s = (Student)(o);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> OrderingM.appends(Stream.of(
            name.compareTo(s.name),
            sex.compareTo(s.sex),
            birthday.compareTo(s.birthday),
            from.compareTo(s.from)
        ));
    }
}</code></pre>
<p>è¿™æ ·çš„å†™æ³•æ¯”ä¸€è¿ä¸² <code>if-else</code> ä¼˜é›…å¤ªå¤šã€‚</p>
<h2 id="æ‰©å±•">æ‰©å±•</h2>
<p>åœ¨ Monoid æ¥å£é‡Œé¢åŠ  default æ–¹æ³•å¯ä»¥æ”¯æŒæ›´å¤šæ–¹ä¾¿çš„æ“ä½œï¼š</p>
<pre><code class="language-java"><span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Monoid</span>&lt;<span class="hljs-title">T</span>&gt; </span>{
    <span class="hljs-comment">//...</span>
    <span class="hljs-function"><span class="hljs-keyword">default</span> T <span class="hljs-title">when</span><span class="hljs-params">(<span class="hljs-keyword">boolean</span> c, T then)</span> </span>{
        <span class="hljs-keyword">if</span> (c) <span class="hljs-keyword">return</span> then;
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> empty();
    }
    <span class="hljs-function"><span class="hljs-keyword">default</span> T <span class="hljs-title">cond</span><span class="hljs-params">(<span class="hljs-keyword">boolean</span> c, T then, T els)</span> </span>{
        <span class="hljs-keyword">if</span> (c) <span class="hljs-keyword">return</span> then;
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> els;
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Todo</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Monoid</span>&lt;<span class="hljs-title">Runnable</span>&gt; </span>{
    <span class="hljs-function"><span class="hljs-keyword">public</span> Runnable <span class="hljs-title">empty</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> () -&gt; {};
    }
    <span class="hljs-function"><span class="hljs-keyword">public</span> Runnable 
    <span class="hljs-title">append</span><span class="hljs-params">(Runnable a, Runnable b)</span> </span>{
        <span class="hljs-keyword">return</span> () -&gt; { a(); b(); };
    }
}</code></pre>
<p>ç„¶åå°±å¯ä»¥åƒä¸‹é¢è¿™æ ·ä½¿ç”¨ä¸Šé¢çš„å®šä¹‰:</p>
<pre><code class="language-java"><span class="hljs-keyword">new</span> Todo.appends(Stream.of(
    logic1,
    () -&gt; { logic2(); },
    Todo.when(condition1, logic3)
))</code></pre>
<blockquote>
<p>æ³¨ï¼šä¸Šé¢çš„ Optional å¹¶ä¸æ˜¯ lazy çš„ï¼Œå®é™…è¿ç”¨ä¸­åŠ ä¸Šéç©ºçŸ­è·¯èƒ½æé«˜æ•ˆç‡ã€‚</p>
</blockquote>
</body>
</html>
