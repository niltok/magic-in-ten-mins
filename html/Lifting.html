<!DOCTYPE html><html lang="zh-CN" prefix="og: https://ogp.me/ns#">
<head >
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title >
ååˆ†é’Ÿé­”æ³•ç»ƒä¹ </title>
<style >
@font-face {
    font-family: "subset body font";
    src: url("body.woff2") format("woff2");
}

@font-face {
    font-family: "subset code font";
    src: url("code.woff2") format("woff2");
}

@font-face {
    font-family: "subset emoji font";
    src: url("emoji.woff2") format("woff2");
}

body {
    max-width: 35em;
    margin: auto;
    width: 90%;
    margin-top: 10%;
    margin-bottom: 10%;
    color: #0B0E26;
    background: #FAFAFC;
    line-height: 1.75em;
    text-rendering: optimizeLegibility;
    text-align: justify;
}

html {
    scroll-behavior: smooth;
    font-size: calc(min(.35vw + 16px, 25px));
    font-family: "subset body font", "Source Han Serif SC", "Noto Serif SC", "Songti SC", SimSun, "AR PL Sungti", "subset emoji font", serif;
}

h1 {
    font-size: 2.5rem;
    color: #EF96AB;
    line-height: 1.5em;
}

h2 {
    margin-top: 2rem;
    line-height: 1.5em;
}

h1,
h2,
h3 {
    /* text-align: center; */
}

blockquote {
    color: gray;
    margin: 0;
    padding: 1px 0 1px 1.2em;
    border-left: .3em solid #EF96AB;
}

code,
pre {
    font-size: 0.9rem;
    line-height: 1.8em;
    font-family: "subset code font", "ç­‰è·æ›´çº±é»‘ä½“ SC", "JetBrains Mono", "Fira Code", Menlo, Monaco, source-code-pro, Courier New, Consolas, "subset emoji font", monospace;
    background: #FCF6FC;
    border-radius: 3px;
    padding-inline: 0.3em;
}

pre {
    overflow-x: auto;
    padding: 1em 1.5em;
}

pre>code {
    padding-inline: 0;
}

::-webkit-scrollbar,
.element::-webkit-scrollbar,
.element {
    /* opacity: 0.5; */
}

a {
    color: #02AEF1;
    text-decoration: none;
}

@media (prefers-color-scheme: dark) {
    body {
        color: #D8D8D6;
        background: #0E0E10;
    }
}

@media (prefers-color-scheme: dark) {

    pre,
    code {
        color: #D8D8D6;
        background: #0E0F1F;
    }
}

.hljs-keyword {
    color: #F288AF;
}

.hljs-comment {
    color: #929CA6;
}

.hljs-string {
    color: #0594A6;
}

.hljs-title {
    color: #4581D9;
}

.hljs-type,
.hljs-built_in {
    color: #fca311;
}</style>
</head>
<body >
<p >
<a href="https://magic.huohuo.moe">ğŸ HomepageğŸ </a> | <a href="https://github.com/niltok/magic-in-ten-mins">â­Star me on GitHubâ­</a></p>
<h1 id="ååˆ†é’Ÿé­”æ³•ç»ƒä¹ ï¼šæå‡">ååˆ†é’Ÿé­”æ³•ç»ƒä¹ ï¼šæå‡</h1>
<h3 id="by-ã€Œç©ç«ã€">By ã€Œç©ç«ã€</h3>
<blockquote>
<p>å‰ç½®æŠ€èƒ½ï¼šJavaåŸºç¡€ï¼ŒHKTï¼ŒMonad</p>
</blockquote>
<h2 id="æ¦‚å¿µ">æ¦‚å¿µ</h2>
<p>æå‡ï¼ˆLiftingï¼‰æŒ‡çš„æ˜¯æŠŠä¸€ä¸ªé€šç”¨å‡½æ•°å˜æˆå®¹å™¨æ˜ å°„å‡½æ•°çš„æ“ä½œã€‚</p>
<p>æ¯”å¦‚æŠŠ <code>Function&lt;A, B&gt;</code> å˜æˆ <code>Function&lt;M&lt;A&gt;, M&lt;B&gt;&gt;</code> å°±æ˜¯ä¸€ç§æå‡æ“ä½œã€‚è€Œç”±äºè¢«æ“ä½œçš„å‡½æ•°æœ‰ä¸€ä¸ªå‚æ•°æ‰€ä»¥è¿™ä¸ªæ“ä½œä¹Ÿå« <code>lift1</code> ã€‚</p>
<p>æ³¨æ„è¢«æå‡çš„å‡½æ•°å¯ä»¥æœ‰ä¸æ­¢ä¸€ä¸ªå‚æ•°ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠ <code>BiFunction&lt;A, B, C&gt;</code> æå‡ä¸º <code>BiFunction&lt;M&lt;A&gt;, M&lt;B&gt;, M&lt;C&gt;&gt;</code> ã€‚è¿™æ ·ä¸¤ä¸ªå‚æ•°çš„æå‡å¯ä»¥ç§°ä¸º <code>lift2</code> ã€‚</p>
<p>åŒæ ·ï¼Œè¢«æå‡çš„å‡½æ•°å¯ä»¥æ²¡æœ‰å‚æ•°ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥çœ‹æˆæ²¡æœ‰è¿™ä¸ªå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯æŠŠ <code>A</code> æå‡ä¸º <code>M&lt;A&gt;</code> ã€‚è¿™æ ·çš„æå‡å¯ä»¥ç§°ä¸º <code>lift0</code> ã€‚å®é™…ä¸Šå®ƒä¹Ÿå’Œ <code>Monad</code> ä¸­çš„ <code>pure</code> æ˜¯åŒæ„çš„ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼š</p>
<pre><code class="language-java">&lt;A&gt; <span class="hljs-function">M&lt;A&gt; 
    <span class="hljs-title">lift0</span><span class="hljs-params">(A f)</span> </span>{}
&lt;A, B&gt; Function&lt;M&lt;A&gt;, M&lt;B&gt;&gt; 
    lift1(Function&lt;A, B&gt; f) {}
&lt;A, B, C&gt; BiFunction&lt;M&lt;A&gt;, M&lt;B&gt;, M&lt;C&gt;&gt;
    lift2(Function&lt;A, B, C&gt;) {}
</code></pre>
<h2 id="fmap">fmap</h2>
<p>çœ‹åˆ°è¿™ä¸ªå‡½æ•°ç­¾åè‚¯å®šæœ‰äººä¼šæ‹æ¡ˆè€Œèµ·ï¼šè¿™ä¸å°±æ˜¯ fmap ä¹ˆï¼Ÿ</p>
<p>fmap is a lifting surly. å› ä¸ºå®ƒç¬¦åˆ lifting çš„å‡½æ•°ç­¾åï¼Œä½†æ˜¯ lifting å¹¶ä¸ä¸€å®šæ˜¯ fmap ã€‚åªè¦ç¬¦åˆè¿™æ ·çš„å‡½æ•°ç­¾åå°±å¯ä»¥è¯´æ˜¯ä¸€ä¸ª lifting ã€‚</p>
<p>æ¯”å¦‚å¯¹äº list æ¥è¯´ <code>f -&gt; x -&gt; x.tail().map(f)</code> ä¹Ÿç¬¦åˆ lifting çš„å‡½æ•°ç­¾åä½†å¾ˆæ˜¾ç„¶å®ƒä¸æ˜¯ä¸€ä¸ª <code>fmap</code> å‡½æ•°ã€‚æˆ–è€…è¯´å¾ˆå¤šæ”¹å˜ç»“æ„çš„å‡½æ•°å’Œ <code>fmap</code> ç»„åˆè¿˜æ˜¯ä¸€ä¸ª lifting å‡½æ•°ã€‚</p>
<h2 id="é™¤æ­¤ä¹‹å¤–å‘¢">é™¤æ­¤ä¹‹å¤–å‘¢</h2>
<p>å›åˆ°ä¸Šé¢é‚£ä¸ªå‡½æ•°ç­¾åï¼Œé‡Œé¢æœ‰ä¸ªéæ³›å‹çš„å‚æ•° <code>M</code> ï¼Œè¿™ä¸ª <code>M</code> å¯ä»¥æ˜¯ä¸ªæ³›å‹å‚æ•°ï¼Œå¯ä»¥æ˜¯ä¸ªåŒ…è£…å™¨æ¯”å¦‚ <code>Maybe</code> ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸ªçº¿æ€§å®¹å™¨æ¯”å¦‚ <code>List</code> ï¼Œå¯ä»¥æ˜¯ä¸ªéçº¿æ€§çš„å®¹å™¨æ¯”å¦‚ <code>Set</code> ï¼Œç”šè‡³å¯ä»¥æ˜¯æŠ½è±¡å®¹å™¨æ¯”å¦‚ <code>Function</code> ã€‚</p>
<p>åŒæ—¶æå‡æ“ä½œä¹Ÿå¯èƒ½å¯¹å®¹å™¨ç»“æ„åšå‡ºä¸€äº›æ”¹å˜ï¼Œå°¤å…¶æ˜¯å¯¹äºå¤šå‚å‡½æ•°çš„æå‡å¯èƒ½ä¼šå¯¹å‡½æ•°çš„å‚æ•°åšå‡ºä¸€äº›ç»„åˆã€‚æ¯”å¦‚å¯¹äº <code>List</code> æ¥è¯´ <code>lift2</code> æ—¢å¯ä»¥æ˜¯ <code>zipMap</code> ä¹Ÿå¯ä¹Ÿæ˜¯ä»¥ <code>f</code> ä¸ºæ“ä½œçš„å·ç§¯ã€‚</p>
<h2 id="liftm">liftM</h2>
<p>å¯¹äº Monad æ¥è¯´ï¼Œå­˜åœ¨ä¸€ç§é€šç”¨çš„æå‡æ“ä½œå« <code>liftM</code> ï¼Œæ¯”å¦‚å¯¹äº <code>List</code> æ¥è¯´ <code>liftM2</code> å°±æ˜¯ï¼š</p>
<pre><code class="language-java">&lt;A, B, C&gt;
BiFunction&lt;List&lt;A&gt;, List&lt;B&gt;, List&lt;C&gt;&gt;
liftM2List(BiFunction&lt;A, B, C&gt; f) {
    HKTListM m = <span class="hljs-keyword">new</span> HKTListM();
    <span class="hljs-keyword">return</span> (ma, mb) -&gt; HKTList.narrow(
             m.flatMap(<span class="hljs-keyword">new</span> HKTList&lt;&gt;(ma),
        a -&gt; m.flatMap(<span class="hljs-keyword">new</span> HKTList&lt;&gt;(mb),
        b -&gt; m.pure(f.apply(a, b))))
    ).value;
}
</code></pre>
<p>è€Œå¯¹ <code>Integer::sum</code> è¿›è¡Œæå‡ä»¥åçš„å‡½æ•°è¾“å…¥ <code>[1, 2, 3]</code> å’Œ <code>[2, 3, 4]</code> å°±ä¼šå¾—åˆ° <code>[3, 4, 5, 4, 5, 6, 5, 6, 7]</code> ã€‚å®é™…ä¸Šå°±æ˜¯å¯¹äºä»»æ„ä¸¤ä¸ªå…ƒç´ ç»„åˆæ“ä½œã€‚</p>
<p>å†æ¯”å¦‚ <code>liftM5</code> åœ¨ <code>Haskell</code> ä¸­çš„è¡¨è¿°ä¸ºï¼š</p>
<pre><code class="language-haskell"><span class="hljs-title">liftM5</span> f ma mb mc md me = <span class="hljs-keyword">do</span>
  a &lt;- ma
  b &lt;- mb
  c &lt;- mc
  d &lt;- md
  e &lt;- me
  pure (f a b c d e)
</code></pre>
<p>ä¹Ÿå°±æ˜¯ <code>liftM[n]</code> å°±ç›¸å½“äºåµŒå¥— <code>n</code> å±‚ <code>flatMap</code> æå– <code>Monad</code> ä¸­çš„å€¼ç„¶ååº”ç”¨ç»™è¢«æå‡çš„å‡½æ•°ã€‚</p>
</body>
</html>
